# 如果你的环境中还没有 ipywidgets，可以取消下面这一行的注释来安装
# !pip install ipywidgets

from datetime import datetime
import ipywidgets as widgets
from IPython.display import display

def datetime_halfway(dt1_str, dt2_str, fmt="%Y-%m-%d %H:%M:%S"):
    dt1 = datetime.strptime(dt1_str, fmt)
    dt2 = datetime.strptime(dt2_str, fmt)
    avg_ts = (dt1.timestamp() + dt2.timestamp()) / 2
    halfway = datetime.fromtimestamp(avg_ts)
    return halfway.strftime(fmt)

# 定义两个文本输入框
entry1 = widgets.Text(
    value='',
    placeholder='YYYY-MM-DD HH:MM:SS',
    description='时间 1:',
    layout=widgets.Layout(width='70%')
)
entry2 = widgets.Text(
    value='',
    placeholder='YYYY-MM-DD HH:MM:SS',
    description='时间 2:',
    layout=widgets.Layout(width='70%')
)

# 定义一个按钮和一个输出区
calc_button = widgets.Button(description='计算中间时间', button_style='primary')
output = widgets.Output()

# 点击按钮时的回调
def on_calc_clicked(b):
    with output:
        output.clear_output()
        dt1_str = entry1.value.strip()
        dt2_str = entry2.value.strip()
        try:
            res = datetime_halfway(dt1_str, dt2_str)
            print(f"中间时间：{res}")
        except Exception:
            print("错误：日期格式无效，请使用 YYYY-MM-DD HH:MM:SS 格式")

calc_button.on_click(on_calc_clicked)

# 把所有部件排版并显示
ui = widgets.VBox([entry1, entry2, calc_button, output])
display(ui)
